'use strict';

angular.module('core').controller('ContactController', ['$scope', '$state', '$http',
  function($scope, $state, $http) {

    // Values necessary for e-mail
    $scope.name = '';
    $scope.email = '';
    $scope.msg = '';

    // Hold captcha data generated by API
    $scope.captcha = '';

    // Create Google Maps window
    $scope.openGoogleMaps = function() {
      console.log('gmaps function called');
      window.open('https://www.google.com/maps/place/University+of+Florida-+Department+of+Computer+and+Information+Science+and+Engineering/@29.6482588,-82.3456859,17z/data=!4m2!3m1!1s0x88e8a39d4f0969b5:0xd21b17bc0529867e');
    };

    // Assign API captcha data to local variable
    $scope.setResponse = function (response) {
      $scope.captcha = response;
    };

    // Called upon
    $scope.cbExpiration = function() {
      console.log('CAPTCHA EXPIRE');
    };

    // Send mail
    $scope.sendMail = function () {

      // Bind local variables to request data
      var data = ({
        name : $scope.name,
        email : $scope.email,
        msg : $scope.msg,
        captcha : $scope.captcha
      });

      // Post data to server
      $http({
        method: 'POST',
        url: '/postMail', 
        data: data
      }).then(function successCallback(response) {
        $state.go('core.home');	//Go to splash page upon successful POST  
      }, function errorCallback(response) {
      });
    };
  }
]);
